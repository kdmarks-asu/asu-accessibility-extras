<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">

    <title>ARIA Live tests</title>
  	<link rel="stylesheet" type="text/css" href="style.css">
    <style>
      html {
        font-family: sans-serif;
      }
      h1 {
        letter-spacing: 2px;
      }
      p {
        line-height: 1.6;
      }
      section {
        padding: 10px;
        width: 400px;
        background: #666;
        text-shadow: 1px 1px 1px black;
        color: white;
        min-height: 150px;
      }
      figcaption {
        background:#fbf28a;
        font-weight: bold;
      }
    </style>
  </head>
<body>
<a class="sr-only" href="#main-content">Skip to main content</a>
<script type="text/javascript" src="menu.js"></script>

<main id="main-content">

    <section aria-live="assertive" aria-atomic="true">
      <h1>ARIA Live tests</h1>
      <blockquote>
        <p></p>
      </blockquote>
    </section>

<h2>1. Aria-Live Example</h2>
JavaScript loads a new random quote into the "section p" element every 10 seconds.
<cite>Example from <a href="https://developer.mozilla.org/en-US/docs/Learn/Accessibility/WAI-ARIA_basics">Mozilla Developer Network</a>.</cite>

<h3>Code:</h3>
<code>
&#160;&#160;&#160;&#160;&lt;section aria-live="assertive" aria-atomic="true"&gt;<br />
&#160;&#160;&#160;&#160;&#160;&#160;&lt;h1&gt;ARIA Live tests&lt;/h1&gt;<br />
&#160;&#160;&#160;&#160;&#160;&#160;&lt;blockquote&gt;<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;p&gt;&lt;/p&gt;<br />
&#160;&#160;&#160;&#160;&#160;&#160;&lt;/blockquote&gt;<br />
&#160;&#160;&#160;&#160;&lt;/section&gt;
</code>

<ul>
	<li>Applying aria-live to a containing element causes screenreaders to read out content inside that container that is updated.</li>
	<li>Possible attribute values are:</li>
	<ul>
	<li>off: The default. Updates should not be announced.</li>
	<li>polite: Updates should be announced only if the user is idle.</li>
	<li>assertive: Updates should be announced to the user as soon as possible.</li>
	</ul>
	<li>The aria-atomic="true" attribute tells screenreaders to read out the entire element contents as one atomic unit, not just the bits that were updated (i.e., will read the heading as well in the example).</li>
	<li>The aria-relevant property also can be used to control what gets read out when a live region is updated--for example, having only content additions or removals read out.</li>
</ul>

<h2>2. Role=Alert Example</h2>
In a list of error messages above a form, the user will be notified when errors are removed or added as they work through the form.

<h3>Code:</h3>
<code>
&lt;div class="errors" role="alert" aria-relevant="all"&gt;<br />
&#160;&#160;&lt;ul&gt;<br />
&#160;&#160;&lt;/ul&gt;<br />
&lt;/div&gt;
</code>

<ul>
	<li>role="alert" automatically turns the element it is applied to into a live region, so changes to it are read out; it also semantically identifies it as an alert message (important time/context sensitive information).</li>
	<li>aria-relevant values are: additions, removals, text, or all.</li>
	<ul>
	<li>in the example above: the value of all instructs the screenreader to read out the contents of the error list when any changes are made to it â€” i.e. when errors are added or removed. This is useful because the user will want to know what errors are left, not just what has been added or removed from the list.</li>
  </ul>
</ul>




<h2>Important Notes about Aria-Live</h2>
<p><a href="https://practical-accessibility.today/chapters/live-regions-2/">Sara Soueidan's chapter</a>, part 2, on aria-live regions is great!</p>
<ul>
	<li>Live region roles are meant to represent short, non-interactive messages that do not require moving the user's focus to. Use an <a href="https://www.w3.org/TR/wai-aria-1.2/https://www.w3.org/TR/wai-aria-1.2#alertdialog">alertdialog</a> instead.</li>
	<li>In an aria-live region, only plain text will be announced. Any markup will be ignored. oO, for instance, &lt;button&gt; would be ignored.</li>
	<li>In addition, aria-live text is "temporary." The screen reader announces it once, then continues reading from where it was previously.</li>
	<li>Also, because focus is not moved to the the aria-live element, it can't contain interactive elements. Not only is the &lt;button&gt; markup dropped, but the focus isn't even on the element, so the user can select it.</li>
</ul>

<h2>When do we need to use a live region or an alert?</h2>
<p>If there's a change in state (true to false), we don't need a live region or an alert.</p>

<p><a href="https://www.w3.org/TR/wai-aria-1.2/#alert">From WCAG 2.1 on Alert</a>:
<blockquote>Neither authors nor user agents are required to set or manage focus to an alert in order for it to be processed. Since alerts are not required to receive focus, authors SHOULD NOT require users to close an alert. If an author desires focus to move to a message when it is conveyed, the author SHOULD use <a href="https://www.w3.org/TR/wai-aria-1.2/https://www.w3.org/TR/wai-aria-1.2#alertdialog">alertdialog</a> instead of alert.</blockquote>
</p>


<figure><img src="images/notify.png" alt="Periodic Table of Elements">
<figcaption>The aria-expanded attribute communicates the state of the disclosure widget to the user. No live region is needed to do that.</figcaption>
</figure>








    <script>
    var quotePara = document.querySelector('section p');
    var quoteJson;
    getQuotes('quotes.json', populateJson);
    var intervalID = window.setInterval(showQuote, 10000);
    function getQuotes(url, callback) {
      var request = new XMLHttpRequest();
      request.open('GET', url);
      request.responseType = 'json';
      request.send();
      request.onreadystatechange = function() {
        if (request.readyState === 4 && request.status === 200) {
          callback(request.response);
        }
      };
    }
    function populateJson(response) {
      quoteJson = response;
    }
    function showQuote() {
      var random = Math.floor((Math.random()*25));
      quotePara.textContent = quoteJson[random].quote + ' -- ' + quoteJson[random].author;
    }
    </script>
  </main>
</body>
</html>